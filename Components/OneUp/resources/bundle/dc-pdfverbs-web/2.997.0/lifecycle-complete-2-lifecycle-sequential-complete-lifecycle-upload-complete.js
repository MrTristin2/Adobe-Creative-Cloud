(window["webpackJsonp-pdfverbs-web"]=window["webpackJsonp-pdfverbs-web"]||[]).push([[4],{Ch9X:function(e,n,t){"use strict";t.d(n,"a",(function(){return b})),t.d(n,"c",(function(){return m})),t.d(n,"b",(function(){return y})),t.d(n,"d",(function(){return dcSocialSignIn})),t.d(n,"e",(function(){return getGoogleYoloRedirectUri}));var r=t("jQsN"),a=t.n(r),o=t("butC"),i=t.n(o),s=t("DjBF"),c=t.n(s),l=t("+lnk"),u=t("2/nz"),d=t("DMWh"),p=l.logging.getLogger("susiUtils"),f=function getBaseRedirectUri(){return l.envUtil.getEnvVar("dc_web_uri")},w=function getRedirectUri(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.assetUri,t=e.assetInputSize,r=e.verb,a=e.deeplink,o=e.additionalParams,i=f();if(!r)return l.router.withQueryParams(i);a?i+=a:i="".concat(i,"/link/home");var s=new URL(i),d=s.searchParams;if(n&&d.append("pdfnow!verb",r),n&&d.append("assetUri",n),l.envUtil.getEnvVar("app_identifier")&&(d.append("x_api_client_id",l.envUtil.getEnvVar("app_identifier")),r&&d.append("x_api_client_location",r.replace(/-/g,"_"))),t&&r===u.f&&d.append("assetInputSize",t),o)for(var p=0,w=Object.entries(o);p<w.length;p++){var _=c()(w[p],2),v=_[0],h=_[1];d.append(v,h)}return l.router.withQueryParams(s.toString())},_=function getSocialRedirectUri(e,n,t){var r=new URL(e);return t&&r.searchParams.append("ims_ac_value","adobe.com_acrobatweb_Verbs_".concat(t,"_Login")),n&&r.searchParams.append("ims_social_provider",n),r.href},v=function(){var e=i()(a.a.mark((function _callee(){var e,n;return a.a.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=window.localStorage.getItem("pdfnow.auth"),t.next=4,l.providers["shared-storage"]();case 4:return n=t.sent,t.next=7,n.setItem("pdfnow.auth",e);case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),p.error("Unable to set value to remote storage: ",t.t0);case 12:case"end":return t.stop()}}),_callee,null,[[0,9]])})));return function setAuthToken(){return e.apply(this,arguments)}}(),h=function(){var e=i()(a.a.mark((function _callee2(e,n){var t;return a.a.wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:if(t=_(e,null,n),"chrome_extension"===l.envUtil.getEnvVar("app_identifier")){r.next=7;break}return r.next=4,v();case 4:window.open(t,"_self"),r.next=8;break;case 7:window.open(t);case 8:case"end":return r.stop()}}),_callee2)})));return function doSignIn(n,t){return e.apply(this,arguments)}}(),g=function(){var e=i()(a.a.mark((function _callee3(e){var n;return a.a.wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.providers["lifecycle-progress"]();case 2:t.sent.sendHostEvent(d.m),n=-1!==e.indexOf("?")?"".concat(e,"&ims_sign_up=true"):"".concat(e,"?ims_sign_up=true"),window.open(n,"_self");case 6:case"end":return t.stop()}}),_callee3)})));return function doSignUp(n){return e.apply(this,arguments)}}(),b=function(){var e=i()(a.a.mark((function _callee4(e){var n,t;return a.a.wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l.providers["lifecycle-progress"]();case 2:return r.sent.sendHostEvent(d.m),n=e.verb,t=w(e),r.next=8,h(t,n);case 8:case"end":return r.stop()}}),_callee4)})));return function dcSignIn(n){return e.apply(this,arguments)}}(),m=function(){var e=i()(a.a.mark((function _callee5(e){var n,t;return a.a.wrap((function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:return n=e.verb,t=w(e),r.next=4,g(t,n);case 4:case"end":return r.stop()}}),_callee5)})));return function dcSignUp(n){return e.apply(this,arguments)}}(),y=function(){var e=i()(a.a.mark((function _callee6(e){var n;return a.a.wrap((function _callee6$(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(l.envUtil.getEnvVar("dc_web_uri"),"/link/home"),l.envUtil.getEnvVar("app_identifier")&&(n="".concat(n,"?x_api_client_id=").concat(l.envUtil.getEnvVar("app_identifier")),e&&(n="".concat(n,"&x_api_client_location=").concat(e.replace(/-/g,"_")))),t.next=4,h(n,e);case 4:case"end":return t.stop()}}),_callee6)})));return function dcSignInToEnv(n){return e.apply(this,arguments)}}();function dcSocialSignIn(e,n){return _dcSocialSignIn.apply(this,arguments)}function _dcSocialSignIn(){return(_dcSocialSignIn=i()(a.a.mark((function _callee7(e,n){var t;return a.a.wrap((function _callee7$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l.providers["lifecycle-progress"]();case 2:return r.sent.sendHostEvent(d.m),r.next=6,v();case 6:t=n.verb,window.open(_(w(n),e,t),"_self");case 8:case"end":return r.stop()}}),_callee7)})))).apply(this,arguments)}function getGoogleYoloRedirectUri(e){return _getGoogleYoloRedirectUri.apply(this,arguments)}function _getGoogleYoloRedirectUri(){return(_getGoogleYoloRedirectUri=i()(a.a.mark((function _callee8(e){return a.a.wrap((function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.providers["lifecycle-progress"]();case 2:return n.sent.sendHostEvent(d.m),n.next=6,v();case 6:return n.abrupt("return",w(e));case 7:case"end":return n.stop()}}),_callee8)})))).apply(this,arguments)}},isbS:function(e,n,t){var r=t("LboF"),a=t("qQL1");"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var o={insert:"head",singleton:!1};r(a,o);e.exports=a.locals||{}},qQL1:function(e,n,t){(n=t("JPst")(!1)).push([e.i,".DownloadOrShare__downloadButton___1PLzf{border-width:0;padding:6px 16px}.DownloadOrShare__downloadButton___1PLzf,.DownloadOrShare__signInToShareButton___3MM-s{border-radius:16px;font-size:14px;font-weight:700;line-height:17px}.DownloadOrShare__signInToShareButton___3MM-s{border-width:2px;color:#4b4b4b;padding:5px 15px}.DownloadOrShare__frictionLessBtnSection___57OCt{display:flex;flex-direction:row;justify-content:center;margin:32px 0}@media (min-width:295px) and (max-width:767px){.DownloadOrShare__frictionLessBtnSection___57OCt{margin:24px 0}}",""]),n.locals={downloadButton:"DownloadOrShare__downloadButton___1PLzf",signInToShareButton:"DownloadOrShare__signInToShareButton___3MM-s",frictionLessBtnSection:"DownloadOrShare__frictionLessBtnSection___57OCt"},e.exports=n},sLmM:function(e,n,t){"use strict";var r,a=t("prSB"),o=t.n(a),i=t("7cf5"),s=t.n(i),c=t("jQsN"),l=t.n(c),u=t("butC"),d=t.n(u),p=t("2bPg"),f=t.n(p),w=t("BRlI"),_=t.n(w),v=t("00an"),h=t.n(v),g=t("tLe6"),b=t.n(g),m=t("q1tI"),y=t.n(m),S=t("17x9"),x=t.n(S),D=t("+lnk"),k=t("LLoy"),U=t("2FAG"),I=t("DMWh"),O=t("3v9k"),C=["assetUri","registerViewerApis","verb","showFilenameToast"],E={path:"/pdfnow",shouldCustomizeGlobalNavBar:!1,shouldDockHUD:!1,shouldRenderCommentsDropin:!1,showHUD:!1,showLHP:!1,shouldDisableDownloadInContextMenu:!0},A=function(e){h()(AcrobatJS,e);var n=b()(AcrobatJS);function AcrobatJS(e){var t;f()(this,AcrobatJS),(t=n.call(this,e)).initializeApis=d()(l.a.mark((function _callee(){var e,n,r,a,o,i;return l.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return e=!0,s.next=3,D.providers.rendition(void 0,{useAJS:!1,usePDFNow:!D.auth2.isSignedIn});case 3:return n=s.sent,r=t.state,a=r.format,o=r.size,i=n.getRendition(t.props.assetUri,{assetType:D.auth2.isSignedIn?void 0:"/pdfnow",format:a,pageNum:1,size:o}),i.ajs.catch((function(){})),t.setState({ready:e}),t.analyticsUtil.sendEvent(t.analyticsSubcategory,O.a.types.preview,O.a.subTypes.generating),s.next=11,D.providers["lifecycle-progress"]();case 11:s.sent.sendHostEvent(I.g);case 13:case"end":return s.stop()}}),_callee)}))),t.viewerRefsInitialized=!1,t.registerViewerApis=function(){var e=d()(l.a.mark((function _callee2(e){var n,r,a;return l.a.wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:if(e&&!t.viewerRefsInitialized){o.next=2;break}return o.abrupt("return");case 2:return t.viewerRefsInitialized=!0,(n=t.props.registerViewerApis)&&n(e),o.next=7,e.getApis("lifecycle-acrobatjs",["documentState"]);case 7:if(r=o.sent,!(a=r.documentState)){o.next=17;break}return o.next=12,a.firstPageLoaded();case 12:return t.analyticsUtil.sendEvent(t.analyticsSubcategory,O.a.types.preview,O.a.subTypes.displayed),o.next=15,D.providers["lifecycle-progress"]();case 15:o.sent.sendHostEvent(I.f);case 17:case"end":return o.stop()}}),_callee2)})));return function(n){return e.apply(this,arguments)}}(),t.state={format:"jpg",ready:!1,size:1200},t.analyticsUtil=new O.b(O.a.workflows.acrobat,"AcrobatJSPreview");var r=t.props.verb;return t.analyticsSubcategory=Object(O.e)(r),t.initializeApis(),t}return _()(AcrobatJS,[{key:"render",value:function render(){var e=this.props,n=e.assetUri,t=(e.registerViewerApis,e.verb,e.showFilenameToast),r=s()(e,C),a=this.state,i=a.format,c=a.ready,l=a.size,u=o()(o()({},E),{},{assetUri:n}),d={FILE_NAME_TOAST:{visible:t}};return c&&y.a.createElement(k.a,Object.assign({id:"viewer",config:u,dcapiConfig:{dcapiRenditionSize:l,dcapiRenditionFormat:i},viewerRef:this.registerViewerApis,UIControlsConfig:d},r,{__self:this,__source:{fileName:"/build/src/components/AcrobatJS/AcrobatJS.jsx",lineNumber:170,columnNumber:16}}))}}]),AcrobatJS}(y.a.Component);A.propTypes={assetUri:x.a.string.isRequired,registerViewerApis:x.a.func,verb:x.a.string.isRequired,showFilenameToast:x.a.bool},A.defaultProps={registerViewerApis:(r=d()(l.a.mark((function _callee3(){return l.a.wrap((function _callee3$(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),_callee3)}))),function registerViewerApis(){return r.apply(this,arguments)}),showFilenameToast:!0};var N=Object(U.a)(A);n.a=N},wpSj:function(e,n,t){"use strict";t.d(n,"a",(function(){return B}));var r,a,o,i=t("jQsN"),s=t.n(i),c=t("butC"),l=t.n(c),u=t("2bPg"),d=t.n(u),p=t("BRlI"),f=t.n(p),w=t("tquP"),_=t.n(w),v=t("00an"),h=t.n(v),g=t("tLe6"),b=t.n(g),m=t("Rk5m"),y=t.n(m),S=t("q1tI"),x=t.n(S),D=t("17x9"),k=t.n(D),U=t("JRPe"),I=t("D3Lu"),O=t.n(I),C=t("+lnk"),E=t("isbS"),A=t.n(E),N=t("Ch9X"),T=t("DMWh"),z=t("3v9k"),F=t("DO1T"),L="/build/src/dropins/LifecycleComplete2/DownloadOrShare/DownloadOrShare.jsx",R=C.logging.getLogger("DownloadOrShare"),B=(o=a=function(e){h()(DownloadOrShare,e);var n,t,r,a=b()(DownloadOrShare);function DownloadOrShare(e){var n;d()(this,DownloadOrShare),(n=a.call(this,e)).onDownload=l()(s.a.mark((function _callee(){var e,t;return s.a.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return e=n.state.downloadCounter,n.setState({downloadClicked:!0}),n.analyticsUtil.sendEvent(n.analyticsSubcategory,z.a.types.complete,e?z.a.subTypes.retryDownloadClicked:z.a.subTypes.downloadClicked),r.prev=3,r.next=6,n.doOnDownload();case 6:r.next=13;break;case 8:r.prev=8,r.t0=r.catch(3),t=r.t0&&"window.open failed"===r.t0.message,n.onDownloadFailed(r.t0,t),R.error("Download failed",r.t0);case 13:case"end":return r.stop()}}),_callee,null,[[3,8]])}))),n.onSignIn=function(){n.analyticsUtil.sendEvent(n.analyticsSubcategory,z.a.types.complete,z.a.subTypes.signInClicked);var e=n.props,t=e.assetUri,r=e.assetInputSize,a=e.verb;Object(N.a)({assetUri:t,assetInputSize:r,verb:a})},n.getBrowser=function(){if(!n.browser){var e=new window.UAParser;n.browser=e.getBrowser()}return n.browser},n.loadUriInIframe=function(e){var t,r=new Date,a=!1,o=document.createElement("iframe");o.onload=function(){a=!0;try{if(!o.contentDocument)return void n.onDownloadFailed(new Error("no contentDocument"));t=new Date}catch(e){return void n.onDownloadFailed(new Error("IE access denied"))}var e=Object(z.d)(t-r),i=n.getAssetMetadataSize();n.analyticsUtil.sendEvent(n.analyticsSubcategory,z.a.types.complete,z.a.subTypes.downloadComplete,{verb:{conversion_duration:e},content:{size:i}})},o.style.cssText="display:none",o.src=e,document.body.appendChild(o),setTimeout((function(){return n.executeTimeout(o,a)}),5e3)},n.executeTimeout=function(e,t){var r=n.getBrowser();if(!t){var a=r.name;"Chrome"!==a&&"Safari"!==a&&"IE"!==a&&"Edge"!==a&&(n.onDownloadFailed(new Error("!gotOnLoad")),e.parentNode.removeChild(e))}},n.tryAnotherFile=l()(s.a.mark((function _callee2(){return s.a.wrap((function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.providers["lifecycle-progress"]();case 2:e.sent.deFocusJob(),n.analyticsUtil.emitTryAnotherFile(n.analyticsSubcategory);case 5:case"end":return e.stop()}}),_callee2)}))),n.uploadProvider=C.providers.upload2,n.renderCta=function(){var e=n.state,t=e.fileDownloaded,r=e.downloadClicked,a=n.props.getJob().nextActionMessage;return t?x.a.createElement(O.a,{className:A.a.downloadButton,onClick:n.tryAnotherFile,variant:"cta","data-test-id":"tryAnotherFile",__self:_()(n),__source:{fileName:L,lineNumber:247,columnNumber:9}},a):x.a.createElement(O.a,{className:A.a.downloadButton,onClick:n.onDownload,variant:"cta","data-test-id":"download",disabled:r,__self:_()(n),__source:{fileName:L,lineNumber:258,columnNumber:7}},x.a.createElement(U.FormattedMessage,{id:"lifecycle.button.download.label",__self:_()(n),__source:{fileName:L,lineNumber:265,columnNumber:9}}))};n.analyticsUtil=new z.b(z.a.workflows.acrobat,"DownloadOrShare");var t=n.props.verb;return n.analyticsSubcategory=Object(z.e)(t),n.state={fileDownloaded:!1,downloadClicked:!1,downloadCounter:0},n}return f()(DownloadOrShare,[{key:"onDownloadFailed",value:(r=l()(s.a.mark((function _callee3(e,n){var t,r;return s.a.wrap((function _callee3$(a){for(;;)switch(a.prev=a.next){case 0:return t="lifecycle.button.download.".concat(n?"blocked":"failed",".label"),r=this.props.intl.formatMessage({id:t}),a.next=4,C.discovery.loadDropinClass("lifecycle-error-state");case 4:a.sent.showToast(r),this.setState({downloadClicked:!1}),this.analyticsUtil.sendEvent(this.analyticsSubcategory,z.a.types.complete,z.a.subTypes.downloadFailure,{verb:{error:e&&e.message||"unknown"}});case 8:case"end":return a.stop()}}),_callee3,this)}))),function onDownloadFailed(e,n){return r.apply(this,arguments)})},{key:"getAssetMetadataSize",value:function getAssetMetadataSize(){var e=this.props.getJob(this.props.jobId);return this.analyticsUtil.getFileSizeBucket(e.size)}},{key:"doOnDownload",value:(t=l()(s.a.mark((function _callee4(){return s.a.wrap((function _callee4$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.generateAndOpenDownloadUri(this.props.jobId);case 2:return this.setState({fileDownloaded:!0,downloadCounter:this.state.downloadCounter+1}),e.next=5,C.providers["lifecycle-progress"]();case 5:e.sent.sendHostEvent(T.d),this.analyticsUtil.sendEvent(this.analyticsSubcategory,z.a.types.complete,this.state.downloadCounter>1?z.a.subTypes.retryDownloadSuccess:z.a.subTypes.downloadSuccess);case 8:case"end":return e.stop()}}),_callee4,this)}))),function doOnDownload(){return t.apply(this,arguments)})},{key:"generateAndOpenDownloadUri",value:(n=l()(s.a.mark((function _callee5(e){var n,t,r,a;return s.a.wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:if(n=!0,this.uri){o.next=10;break}return o.next=4,this.uploadProvider();case 4:return t=o.sent,o.next=7,t.getDownloadUri(e,n);case 7:r=o.sent,a=r.content.uri,this.uri=a;case 10:this.openDownloadUri(this.uri);case 11:case"end":return o.stop()}}),_callee5,this)}))),function generateAndOpenDownloadUri(e){return n.apply(this,arguments)})},{key:"openDownloadUri",value:function openDownloadUri(e){if(Object(F.a)()){var n=window.open(e);if(null==n||void 0===n)throw new Error("window.open failed")}else this.loadUriInIframe(e)}},{key:"render",value:function render(){return x.a.createElement("div",{className:A.a.frictionLessBtnSection,__self:this,__source:{fileName:L,lineNumber:272,columnNumber:7}},this.renderCta(),x.a.createElement(O.a,{className:A.a.signInToShareButton,onClick:this.onSignIn,__self:this,__source:{fileName:L,lineNumber:274,columnNumber:9}},x.a.createElement(U.FormattedMessage,{id:"lifecycle.button.signin.label",__self:this,__source:{fileName:L,lineNumber:278,columnNumber:11}})))}}]),DownloadOrShare}(x.a.Component),a.propTypes={jobId:k.a.string.isRequired,getJob:k.a.func.isRequired,assetUri:k.a.string,assetInputSize:k.a.number,verb:k.a.string,intl:U.intlShape.isRequired},a.defaultProps={assetUri:null,assetInputSize:0,verb:null},r=o,y()(r.prototype,"onDownloadFailed",[C.bindAndCatch],Object.getOwnPropertyDescriptor(r.prototype,"onDownloadFailed"),r.prototype),r);n.b=Object(U.injectIntl)(B)}}]);
