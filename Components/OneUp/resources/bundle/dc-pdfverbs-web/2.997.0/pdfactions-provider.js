(window["webpackJsonp-pdfverbs-web"]=window["webpackJsonp-pdfverbs-web"]||[]).push([[50],{"8cSA":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var r=n("DjBF"),a=n.n(r),s=n("upjz"),i=n.n(s),o=n("prSB"),c=n.n(o),u=n("jQsN"),p=n.n(u),l=n("butC"),d=n.n(l),f=n("2bPg"),g=n.n(f),m=n("BRlI"),v=n.n(m),_=n("+lnk"),b=n("nOB5"),h=n("RZ3+"),x=n("2/nz"),P=n("ip5t"),y=n("gmKw"),w=function(){function PdfActionsProvider(){var e=this;g()(this,PdfActionsProvider),this.isIntegration=function(){return"integration"===_.envUtil.getEnvVar("app_identifier")},this.ready=d()(p.a.mark((function _callee(){var t;return p.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_.providers.dcapi();case 2:return t=n.sent,e.dcapi=t.getDcapi(),n.next=6,_.providers["lifecycle-progress"]();case 6:return e.lifecycleProgress=n.sent,n.next=9,_.providers.asset2();case 9:return e.assetProvider=n.sent,n.abrupt("return",e);case 11:case"end":return n.stop()}}),_callee)}))),this.getPdfActions=function(e){var t={optimize:{compress:!0}};return e.quality&&(t.optimize.params={compression_level:e.quality}),t},this.compressPdf=function(){var t=d()(p.a.mark((function _callee2(t){var n,r,a,s,i,o,u,l,d,f=arguments;return p.a.wrap((function _callee2$(p){for(;;)switch(p.prev=p.next){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:{},r=e.lifecycleProgress.getJobById(t),a=r.inputAsset,s=void 0===a?{}:a,!(i=r.assetForOperation||{}).externalAssetPromise){p.next=9;break}return p.next=7,i.externalAssetPromise;case 7:o=p.sent,i=o.asset;case 9:if(u={persistence:"transient"},!_.auth2.isSignedIn||e.isIntegration()||i.origAsset||s.origAsset){p.next=15;break}return p.next=13,e.assetProvider.getFolderRoot();case 13:u.parent_uri=p.sent,u.persistence="permanent";case 15:return l={"x-request-id":e.dcapi.getUuid("cp")},p.next=18,Object(P.H)();case 18:if(!p.sent){p.next=25;break}return l["x-user-action-name"]="compress-pdf",p.next=23,Object(P.x)("dcweb/mock_data");case 23:(d=p.sent)&&d.mock_limit_verb_expiry&&(l["X-Verb-Expiry"]=d.mock_limit_verb_expiry);case 25:return p.abrupt("return",e.dcapi.call(h.c,{accept:b.a.new_asset_job_v1,content:c()({assets:[{asset_uri:e.assetProvider.uriFromAsset(i)}],name:i.name.replace(/\.[^.]*$/,n.filenameSuffix),pdf_actions:[e.getPdfActions(n)]},u),content_type:b.a.pdf_actions_parameters,headers:l}).then((function(n){return e.lifecycleProgress.updateJob({jobId:t,acrobatResponse:n}),e.lifecycleProgress.startFetchStatus(t)})));case 26:case"end":return p.stop()}}),_callee2)})));return function(e){return t.apply(this,arguments)}}(),this.commitPdfAction=function(){var t=d()(p.a.mark((function _callee3(t,n,r){var a,s,o,u,l,d,f,g,m,v,w,k,A,j,I,S,O,R,F,C,J,q,B,N,z;return p.a.wrap((function _callee3$(p){for(;;)switch(p.prev=p.next){case 0:return s=e.lifecycleProgress.getJobById(t),o=s.overwriteOnSave,u=void 0!==o&&o,l=s.settingsDropinParams,d=l.dataSource,f=l.customDataSource,g=l.outputFilename,v=(m=f||d).sections,w=m.rotations,k=(a=[]).concat.apply(a,i()(v)),p.next=8,Object(P.H)();case 8:if((I=p.sent)&&(A=r,j=e.dcapi.getUuid(A.includes("combine")?"cm":"or")),A||(A=n==="verb-".concat(x.d)?"Combine":"Organize",j=e.dcapi.getUuid("Combine"===A?"cm":"or")),S={"x-user-action-name":A,"x-request-id":j},!I){p.next=17;break}return p.next=15,Object(P.x)("dcweb/mock_data");case 15:(O=p.sent)&&O.mock_limit_verb_expiry&&(S["X-Verb-Expiry"]=O.mock_limit_verb_expiry);case 17:if((R=e.generateComborgRequestContent(k,A,w)).name="".concat(g,".pdf"),R.persistence="transient",F=s.assetForOperation,C=void 0===F?{}:F,J=s.inputAsset,q=void 0===J?{}:J,!_.auth2.isSignedIn||e.isIntegration()||C.origAsset||q.origAsset||(R.persistence="permanent"),"permanent"!==R.persistence||!Object(y.a)(s)){p.next=30;break}return p.next=25,_.providers.asset2();case 25:return B=p.sent,p.next=28,B.getFolderRoot();case 28:N=p.sent,R.parent_uri=N;case 30:return z=u?"overwrite":"auto_rename",p.abrupt("return",e.dcapi.call(h.c,{accept:b.a.new_asset_job_v1,content_type:b.a.pdf_actions_parameters,content:c()(c()({},R),{},{on_dup_name:z}),headers:S}).then((function(n){return e.lifecycleProgress.updateJob({jobId:t,acrobatResponse:n}),e.lifecycleProgress.startFetchStatus(t)})));case 32:case"end":return p.stop()}}),_callee3)})));return function(e,n,r){return t.apply(this,arguments)}}(),this.getPageRange=function(e){var t="",n=null,r=e[0];return e.concat([-1]).forEach((function(e){n&&e-n==1||n&&(t.length&&(t+=","),t+=r===n?r.toString():"".concat(r.toString(),"-").concat(n.toString()),r=e),n=e})),t},this.extractPageNumsFromRanges=function(e){for(var t=[],n=function _loop(n){var r=a()(e[n],2),s=r[0],o=r[1];if(o){var c=o-s+1;t.push.apply(t,i()(Array(c).fill().map((function(e,t){return s+t}))))}else t.push(s)},r=0;r<e.length;r++)n(r);return t}}return v()(PdfActionsProvider,[{key:"generateComborgRequestContent",value:function generateComborgRequestContent(e,t,n){for(var r,a,s=this,i=[],o={},c=null,u=null,p=[],l={90:[],180:[],270:[]},d=function _loop2(t){if(e[t]&&(u=e[t].parentAssetId),c&&u!==c||t===e.length){r={asset_uri:s.assetProvider.getAssetURI(c)};var a=s.getPageRange(p.map((function(e){return e.pageNum||(e.ranges||[]).map((function(e){return e.join("-")})).join(",")})));a&&Object.assign(r,{include:a});var o=[];Object.keys(l).forEach((function(e){return l[e].length&&o.push({rotate:{angle:Number(e),pages:s.getPageRange(l[e])}})})),o.length&&(r.page_actions=o),i.push(r),p=[],l={90:[],180:[],270:[]}}if(e[t])if(p.push(e[t]),e[t].ranges){s.extractPageNumsFromRanges(e[t].ranges).forEach((function(r){var a=n["".concat(e[t].id,"--").concat(r)];a&&a>0&&l[a].push(r)}))}else{var d=e[t].rotation,f=e[t].pageNum;d&&d>0&&l[d].push(f)}c=u},f=0;f<=e.length;f+=1)d(f);(o.assets=i,_.auth2.isSignedIn)||(a="Combine"===t?{combine:{}}:{organize:{}},o.pdf_actions=[a]);return o}}]),PdfActionsProvider}();w.getInstance=_.providerUtil.getSingletonFunction(w)},gmKw:function(e,t,n){"use strict";var r=n("jQsN"),a=n.n(r),s=n("butC"),i=n.n(s),o=n("+lnk"),c=function(){var e=i()(a.a.mark((function _callee(e){var t,n,r,s,i;return a.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(t=e.assetForOperation,n=e.childJobIds,!t||!t.parcel_id||t.is_original_shared){a.next=3;break}return a.abrupt("return",!0);case 3:return a.next=5,o.providers["lifecycle-progress"]();case 5:return r=a.sent,s=n.map((function(e){return r.getJobById(e)})),i=s.find((function(e){var t=e.assetForOperation;return t&&t.parcel_id&&!t.is_original_shared})),a.abrupt("return",void 0!==i);case 9:case"end":return a.stop()}}),_callee)})));return function isOldShare(t){return e.apply(this,arguments)}}();t.a=c}}]);
